# **Лекция 12: Основы Bash — Практическое руководство для Senior-разработчика на Flutter**

---

## **Введение**
Bash (Bourne-Again Shell) — это интерактивная оболочка командной строки, которая является стандартом для большинства Unix-подобных систем (включая Linux и macOS). Для разработчиков на Flutter Bash — неотъемлемый инструмент для работы с файловой системой, автоматизации задач, управления зависимостями и отладки приложений. Понимание основ Bash позволяет эффективно взаимодействовать с операционной системой, ускорять разработку и улучшать качество кода.

Эта лекция охватывает ключевые аспекты работы в Bash, необходимые для Senior-разработчика на Flutter. Мы рассмотрим команды, скрипты, фильтрацию данных, управление процессами и многое другое с примерами, которые можно применить в реальных проектах.

---

## **1. Что такое Bash? Аналоги. Hashbang**

### **Что такое Bash**
Bash — это интерпретатор командной строки, который предоставляет пользователю среду для выполнения команд и написания скриптов. Он поддерживает такие функции, как:
- Переменные
- Условные операции (if/else)
- Циклы (for, while)
- Работа с файлами и папками
- Пайпы и перенаправление потоков

### **Аналоги Bash**
- **Zsh** — современная оболочка с расширенными функциями автодополнения и настройкой.
- **Fish (Friendly Interactive Shell)** — пользовательский интерфейс с интуитивно понятной командой.
- **PowerShell** — оболочка, ориентированная на Windows, но совместимая с Linux через WSL.

В Flutter-разработке Bash часто используется из-за широкой поддержки в DevOps-инструментах (Docker, CI/CD).

### **Hashbang**
Hashbang (`#!/bin/bash`) — это специальная строка в начале скрипта, которая указывает системе, каким интерпретатором должен быть выполнен файл. Например:

```bash
#!/bin/bash
echo "Привет, Flutter!"
```

**Зачем это нужно?**
- Если вы запускаете скрипт напрямую (например, `./script.sh`), система использует hashbang для определения интерпретатора.
- Без него может возникнуть ошибка: `Permission denied` или выполнение через другой интерпретатор.

**Пример в Flutter проекте:**
```bash
#!/bin/bash
# Скрипт для сборки и тестирования Flutter-приложения
flutter build apk && flutter test
```

---

## **2. Получение помощи: man**

### **Команда `man` (manual)**
`man` — это команда, которая выводит подробную документацию по командам Bash.

**Пример использования:**
```bash
man ls  # Просмотр руководства по команде ls
```

**Как использовать:**
- Используйте стрелки вверх/вниз для прокрутки.
- Нажмите `q`, чтобы выйти из документации.

**Пример с Flutter:**
```bash
man flutter  # Получение информации о командах Flutter
```

---

## **3. Навигация по файловой системе**

### **Основные команды**
- `pwd` — вывод текущей директории (present working directory).
- `ls` — список содержимого папки.
- `cd` — смена директории.

**Пример:**
```bash
cd ~/Documents/flutter_project  # Перемещение в проект Flutter
pwd                            # Проверка пути
ls                             # Просмотр файлов и папок
```

### **Полезные флаги `ls`:**
- `-a` — показать скрытые файлы.
- `-l` — подробный вывод (разрешения, владельцы, размер).
- `-R` — рекурсивный вывод.

**Пример в Flutter:**
```bash
ls -la lib/  # Просмотр содержимого папки `lib`
```

---

## **4. Запись результатов выполнения команд в файл (stdout, stderr)**

### **Перенаправление потоков**
- `>` — перенаправить stdout в файл.
- `>>` — добавить вывод в конец файла.
- `2>` — перенаправить stderr.
- `&>` или `>&` — перенаправить все потоки.

**Пример:**
```bash
flutter build apk > output.log 2> errors.log
# stdout сохранится в output.log, stderr — в errors.log
```

### **Комбинации:**
```bash
flutter test >> test_results.txt  # Добавление вывода в файл
```

---

## **5. Создание каталогов и файлов**

### **Команды:**
- `mkdir` — создать директорию.
- `touch` — создать пустой файл или обновить время последнего изменения.

**Пример:**
```bash
mkdir -p src/utils  # Создание вложенной структуры каталогов
touch main.dart     # Создание файла main.dart
```

---

## **6. Просмотр каталогов и файлов (cat, tail)**

### **`cat` — вывод содержимого файла**
```bash
cat main.dart  # Вывод содержимого файла в терминал
```

**Полезный флаг:**
- `cat -n` — нумерация строк.

### **`tail` — просматривать конец файла**
```bash
tail -n 10 output.log  # Показать последние 10 строк лога
```

**Пример в Flutter:**
```bash
tail -f flutter_error.log  # Непрерывный вывод новых строк (полезно для отладки)
```

---

## **7. Разрешения: chmod**

### **Что такое разрешения?**
Разрешения определяют, кто может читать/писать/запускать файлы и папки.

**Формат разрешений:**
- `r` — read (читать)
- `w` — write (писать)
- `x` — execute (выполнять)

**Таблица владельцев:**
| Пользователь | Символ |
|-------------|--------|
| Владелец     | u      |
| Группа       | g      |
| Остальные    | o      |
| Все         | a      |

### **Примеры:**
```bash
chmod +x script.sh  # Добавить разрешение на выполнение для всех
chmod 755 build_script.sh  # Установка разрешений (владелец: rwx, остальные: r-x)
```

**Зачем это нужно в Flutter?**
- Чтобы скрипты сборки могли выполняться без ошибок.
- Для безопасного запуска тестов и инструментов.

---

## **8. Суперпользователь: sudo**

### **Команда `sudo`**
Используется для выполнения команд с правами администратора (root).

**Пример:**
```bash
sudo flutter pub get  # Установка зависимостей Flutter с правами root
```

**Важно!**
- Используйте `sudo` только при необходимости.
- В Flutter проектах часто не требуется sudo, за исключением случаев с установкой пакетов или настройкой среды.

---

## **9. Фильтрация вывода: grep**

### **Команда `grep`**
Используется для поиска строк в файлах и потоках данных.

**Пример:**
```bash
grep "error" output.log  # Поиск словосочетания "error" в файле
```

### **Флаги:**
- `-i` — игнорировать регистр.
- `-r` — рекурсивный поиск в папках.
- `--color=auto` — выделение совпадений цветом.

**Пример в Flutter:**
```bash
grep -r "NetworkError" lib/  # Поиск ошибок сети в коде
```

---

## **10. Поиск и остановка запущенных процессов (ps, kill)**

### **`ps` — просмотр активных процессов**
```bash
ps aux | grep flutter  # Показать процессы с названием "flutter"
```

**Флаги:**
- `a` — все процессы
- `x` — включить процессы, не связанные с терминалом

### **`kill` — завершение процесса**
```bash
kill 12345  # Завершить процесс по PID (Process ID)
```

**Пример:**
```bash
ps aux | grep "flutter run"  # Найти идентификаторы процессов flutter run
kill -9 $(pgrep flutter)    # Убить все процессы flutter
```

---

## **11. Команда `echo`**

### **Использование:**
```bash
echo "Hello, Flutter!"  # Вывести текст в терминал
```

**Полезные применения:**
- Генерация файлов.
- Запись переменных в скрипты.

**Пример:**
```bash
echo "void main() => runApp(MyApp());" > main.dart  # Создание файла main.dart
```

---

## **12. Условный оператор**

### **Синтаксис:**
```bash
if условие; then
    команда1
    команда2
fi
```

**Пример в Flutter:**
```bash
if [ -f "pubspec.yaml" ]; then
    echo "Файл pubspec.yaml существует"
else
    echo "Файла pubspec.yaml нет"
fi
```

### **Операторы сравнения:**
- `-f` — файл существует.
- `-d` — директория существует.
- `-e` — файл или папка существуют.
- `>` — больше, чем.
- `<` — меньше, чем.

---

## **13. Цикл for**

### **Синтаксис:**
```bash
for переменная in список; do
    команда с переменной
done
```

**Пример в Flutter:**
```bash
for file in lib/**/*.dart; do
    echo "Обработка файла: $file"
done
```

### **Цикл по числам:**
```bash
for i in {1..5}; do
    echo "Итерация $i"
done
```

---

## **14. Функции**

### **Создание функции в Bash:**
```bash
build_flutter() {
    flutter clean
    flutter build apk
}
```

**Вызов функции:**
```bash
build_flutter
```

### **Пример для Flutter-проекта:**
```bash
test_flutter() {
    echo "Запуск тестов..."
    flutter test
    if [ $? -eq 0 ]; then
        echo "Тесты пройдены успешно"
    else
        echo "Ошибка в тестах"
    fi
}
```

**Пояснение:**
- `$?` — код выхода последней команды (0 = успех).

---

## **Практическое задание**

### **Задача:** Создайте скрипт для автоматизации разработки Flutter приложения.
1. Скрипт должен:
   - Проверять наличие `pubspec.yaml`.
   - Если файл существует, выполнить `flutter pub get` и `flutter build apk`.
   - В противном случае вывести предупреждение о необходимости создания файла.

2. Сохраните скрипт в папку проекта как `build_script.sh`.

3. Убедитесь, что он запускается без ошибок с помощью команды:
```bash
chmod +x build_script.sh && ./build_script.sh
```

**Пример реализации:**
```bash
#!/bin/bash

if [ -f "pubspec.yaml" ]; then
    echo "Загрузка зависимостей..."
    flutter pub get
    echo "Сборка APK..."
    flutter build apk
else
    echo "Ошибка: отсутствует файл pubspec.yaml"
fi
```

---

## **Контрольные вопросы**

1. Что такое `hashbang`, и как он используется в скриптах?
2. Какие команды используются для навигации по файловой системе?
3. Для чего нужен `chmod`? Приведите пример.
4. Как перенаправить вывод команды в файл?
5. Что делает команда `grep`, и как она используется в Flutter-проектах?
6. Как найти PID процесса с помощью `ps`, и как его завершить?
7. Как использовать условный оператор для проверки существования файла?
8. Какие флаги у команды `tail`?
9. Что такое функция в Bash, и как она используется в скриптах Flutter-проекта?

---

## **Литература и ссылки**

1. [The Linux Command Line: A Complete Introduction (Book)](https://linuxcommand.org/)
2. [Bash Guide for Beginners](https://tldp.org/LDP/Bash-Beginners-Guide/html/)
3. [Flutter Documentation — Terminal and CLI Tools](https://docs.flutter.dev)
4. [GNU Core Utilities Manual](https://www.gnu.org/software/coreutils/manual/html_node/)
5. [Stack Overflow — Bash Scripting FAQ](https://stackoverflow.com/questions/592620/im-trying-to-write-a-bash-script-and-i-m-not-sure-how-to-start)

--- 

Эта лекция охватывает все ключевые аспекты работы с Bash для разработчиков Flutter. Следуя ей, вы сможете эффективно использовать терминал и автоматизировать рутинные задачи в своих проектах. Удачи на пути к Senior-статусу! 🚀